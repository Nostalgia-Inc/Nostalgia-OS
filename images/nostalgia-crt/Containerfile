FROM ghcr.io/ublue-os/bazzite:latest

LABEL org.opencontainers.image.title="Nostalgia OS"
LABEL org.opencontainers.image.description="KDE-based image with Arduino IDE (Flatpak) and EmuDeck setup on first boot"
LABEL org.opencontainers.image.authors="Nostalgia Inc."
LABEL org.opencontainers.image.source="https://github.com/Nostalgia-Inc/Nostalgia-OS"

# Copy branding and first-boot content from this directory's subfolders
# (Because the workflow build context is images/nostalgia-os)
# from repo root now:
COPY common/                                   /usr/share/nostalgia/
COPY images/nostalgia-crt/firstboot/10-nostalgia-setup.sh      /usr/lib/nostalgia/10-firstboot.sh
COPY images/nostalgia-crt/firstboot/nostalgia-firstboot.service /etc/systemd/system/nostalgia-firstboot.service
# (optional, if you ship autologin)
COPY images/nostalgia-crt/firstboot/00-sddm-autologin.conf     /etc/sddm.conf.d/00-autologin.conf


# Make first-boot script executable and enable the unit
RUN chmod +x /usr/lib/nostalgia/10-firstboot.sh && \
    systemctl enable nostalgia-firstboot.service
